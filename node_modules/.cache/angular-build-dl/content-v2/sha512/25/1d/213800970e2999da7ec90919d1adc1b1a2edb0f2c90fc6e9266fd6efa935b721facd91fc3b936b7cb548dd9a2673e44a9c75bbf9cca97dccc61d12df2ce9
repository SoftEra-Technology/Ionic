(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"+plB":function(T,E,t){"use strict";t.r(E);var A=t("8Y7J");class D{}var I=t("pMnS"),e=t("MKJQ"),S=t("sZkV"),_=t("SVse"),n=t("6GXZ"),l=t("xoVG"),N=t("kwUn");class O{constructor(T,E,t,A,D,I){this.userService=T,this.router=E,this.network=t,this.platform=A,this.sqlite=D,this.activatedRoute=I,this.database_name="AUDIT_DB.db",this.activatedRoute.queryParams.subscribe(T=>{console.log(JSON.parse(T.value)),this.Query_data=JSON.parse(T.value),console.log("list page"),console.log(this.Query_data.AttemptedId),this.fetchAttemptedAuditForStore(Number(this.Query_data.AuditId),this.Query_data.Storeid),this.fetchAttemptedSection(Number(this.Query_data.AttemptedId),Number(this.Query_data.AuditId))}),this.platform.ready().then(()=>{this.createDB()}).catch(T=>{console.log(T)})}ngOnInit(){}createDB(){console.log("database created"),this.sqlite.create({name:this.database_name,location:"default"}).then(T=>{this.databaseObj=T}).catch(T=>{alert("error "+JSON.stringify(T))})}fetchAttemptedAuditForStore(T,E){this.databaseObj.executeSql("SELECT * AUDIT_ATTEMPTED_TB where AUDIT_ID="+T+" AND STR_CODE='"+E+"' ORDER BY ATTEMPTED_ID DESC",[]).then(T=>{if(this.AttemptedAuditForStore=[],console.log(T),T.rows.length>0){for(var E=0;E<T.rows.length;E++)this.AttemptedAuditForStore.push(T.rows.item(E));console.log(this.AttemptedAuditForStore)}}).catch(T=>{console.log("error "+JSON.stringify(T))})}fetchAttemptedSection(T,E){this.databaseObj.executeSql("SELECT B.SECTION_NAME AS P_SECTION_NAME,A.ATTEMPTED_ID,A.AUDIT_ID,A.SECTION_ID,A.PARENT_SECTION_ID,A.SECTION_NAME,A.SECTION_DESC,A.SECTION_ORDER,A.SECTION_PT,A.T_QUESTION_COUNT,((SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND AUDIT_ID=A.AUDIT_ID AND SECTION_ID=A.SECTION_ID AND QUESTION_STATUS<>'Open')+(SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND AUDIT_ID=A.AUDIT_ID AND QUESTION_STATUS<>'Open' AND SECTION_ID IN(SELECT SECTION_ID FROM AUDIT_ATTEMPTED_SECTION WHERE PARENT_SECTION_ID=A.SECTION_ID))) AS ATTEMPTQUESTION,(SELECT SUM(QUESTION_MARKS) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND SECTION_ID=A.SECTION_ID AND IS_INCLUDED='Yes') AS SECTION_MARKS,(IFNULL((SELECT SUM(MARKS_SCORED) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND SECTION_ID=A.SECTION_ID AND IS_INCLUDED='Yes'),0)+IFNULL((SELECT SUM(MARKS_SCORED) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND IS_INCLUDED='Yes' AND SECTION_ID IN(SELECT SECTION_ID FROM AUDIT_ATTEMPTED_SECTION WHERE PARENT_SECTION_ID=A.SECTION_ID)),0)) AS MARKS_SCORED FROM AUDIT_ATTEMPTED_SECTION A LEFT JOIN AUDIT_ATTEMPTED_SECTION B ON A.PARENT_SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID=B.ATTEMPTED_ID WHERE A.ATTEMPTED_ID="+T+" AND A.S_QUESTION_COUNT>0",[]).then(T=>{if(this.AttemptedSection=[],console.log(T),T.rows.length>0){for(var E=0;E<T.rows.length;E++)this.AttemptedSection.push(T.rows.item(E));console.log(this.AttemptedSection)}}).catch(T=>{console.log("error "+JSON.stringify(T))})}fetchAttemptedOpenAuditByUser(T){this.databaseObj.executeSql("SELECT ATTEMPTED_ID,AUDIT_ID,AUDIT_NAME,STR_CODE,STR_NAME,USER_ID,STR_MANAGER,AUDIT_DT,AUDIT_STATUS,(SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=t.ATTEMPTED_ID AND AUDIT_ID=t.AUDIT_ID) AS TOTALQUESTION,(SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=t.ATTEMPTED_ID AND AUDIT_ID=t.AUDIT_ID AND QUESTION_STATUS<>'Open') AS ATTEMPTQUESTION,(SELECT SUM(QUESTION_MARKS) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=t.ATTEMPTED_ID AND IS_INCLUDED='Yes') AS AUDIT_POINTS,IFNULL((SELECT SUM(MARKS_SCORED) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=t.ATTEMPTED_ID AND QUESTION_STATUS<>'Open'),0) MARKS_SCORED,UNIQUE_ID FROM AUDIT_ATTEMPTED_TB t WHERE USER_ID='"+T+"' AND AUDIT_STATUS='Open'",[]).then(T=>{if(this.AttemptedOpenAuditByUser=[],console.log(T),T.rows.length>0){for(var E=0;E<T.rows.length;E++)this.AttemptedOpenAuditByUser.push(T.rows.item(E));return this.AttemptedOpenAuditByUser}}).catch(T=>{alert("error "+JSON.stringify(T))})}fetchAttemptedAuditBySQL(T,E){this.databaseObj.executeSql("SELECT AUDIT_ID,AUDIT_NAME,STR_CODE,STR_NAME,USER_ID,STR_MANAGER,AUDIT_DT,UNIQUE_ID FROM AUDIT_ATTEMPTED_TB WHERE ATTEMPTED_ID="+T+" AND AUDIT_ID="+E,[]).then(T=>{if(this.AttemptedAuditBySQL=[],console.log(T),T.rows.length>0){for(var E=0;E<T.rows.length;E++)this.AttemptedAuditBySQL.push(T.rows.item(E));return this.AttemptedAuditBySQL}}).catch(T=>{alert("error "+JSON.stringify(T))})}fetchAttemptedSectionQuestionBySQL(T,E,t,A){if("Audit"==T?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+E+" AND A.AUDIT_ID="+t,[]).then(T=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(T),T.rows.length>0)for(var E=0;E<T.rows.length;E++)this.AttemptedSectionQuestionBySQL.push(T.rows.item(E))}).catch(T=>{alert("error "+JSON.stringify(T))}):"Section"==T?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+E+" AND A.AUDIT_ID="+t+" AND A.SECTION_ID="+A,[]).then(T=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(T),T.rows.length>0)for(var E=0;E<T.rows.length;E++)this.AttemptedSectionQuestionBySQL.push(T.rows.item(E))}).catch(T=>{alert("error "+JSON.stringify(T))}):"Question"==T?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+E+" AND A.AUDIT_ID="+t+" AND B.QUESTION_ID="+A,[]).then(T=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(T),T.rows.length>0)for(var E=0;E<T.rows.length;E++)this.AttemptedSectionQuestionBySQL.push(T.rows.item(E))}).catch(T=>{alert("error "+JSON.stringify(T))}):this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+E+" AND A.AUDIT_ID="+t+" AND 1=2",[]).then(T=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(T),T.rows.length>0)for(var E=0;E<T.rows.length;E++)this.AttemptedSectionQuestionBySQL.push(T.rows.item(E))}).catch(T=>{alert("error "+JSON.stringify(T))}),this.AttemptedSectionQuestionBySQL.length>0)return this.AttemptedSectionQuestionBySQL}}var i=t("iInd"),o=A.ob({encapsulation:0,styles:[[""]],data:{}});function s(T){return A.Hb(0,[(T()(),A.qb(0,0,null,null,3,"div",[],null,null,null,null,null)),(T()(),A.qb(1,0,null,null,2,"div",[],null,null,null,null,null)),(T()(),A.qb(2,0,null,null,1,"a",[],[[8,"href",4]],null,null,null,null)),(T()(),A.Gb(3,null,["Audit: ",""]))],null,(function(T,E){T(E,2,0,A.ub(1,"",E.context.$implicit.AUDIT_ID,"")),T(E,3,0,E.context.$implicit.AUDIT_NAME)}))}function r(T){return A.Hb(0,[(T()(),A.qb(0,0,null,null,6,"ion-header",[],null,null,null,e.s,e.f)),A.pb(1,49152,null,0,S.y,[A.h,A.k,A.x],null,null),(T()(),A.qb(2,0,null,0,4,"ion-toolbar",[],null,null,null,e.z,e.m)),A.pb(3,49152,null,0,S.wb,[A.h,A.k,A.x],null,null),(T()(),A.qb(4,0,null,0,2,"ion-title",[],null,null,null,e.y,e.l)),A.pb(5,49152,null,0,S.ub,[A.h,A.k,A.x],null,null),(T()(),A.Gb(-1,0,["ListAudit"])),(T()(),A.qb(7,0,null,null,3,"ion-content",[],null,null,null,e.p,e.c)),A.pb(8,49152,null,0,S.r,[A.h,A.k,A.x],null,null),(T()(),A.fb(16777216,null,0,1,null,s)),A.pb(10,278528,null,0,_.h,[A.L,A.I,A.q],{ngForOf:[0,"ngForOf"]},null)],(function(T,E){T(E,10,0,E.component.AttemptedAuditForStore)}),null)}function u(T){return A.Hb(0,[(T()(),A.qb(0,0,null,null,1,"app-list-audit",[],null,null,null,r,o)),A.pb(1,114688,null,0,O,[N.a,i.m,l.a,S.Cb,n.a,i.a],null,null)],(function(T,E){T(E,1,0)}),null)}var U=A.mb("app-list-audit",O,u,{},{},[]),M=t("s7LF");class a{}t.d(E,"ListAuditPageModuleNgFactory",(function(){return h}));var h=A.nb(D,[],(function(T){return A.zb([A.Ab(512,A.j,A.Y,[[8,[I.a,U]],[3,A.j],A.v]),A.Ab(4608,_.j,_.i,[A.s,[2,_.p]]),A.Ab(4608,M.n,M.n,[]),A.Ab(4608,S.a,S.a,[A.x,A.g]),A.Ab(4608,S.Ab,S.Ab,[S.a,A.j,A.p]),A.Ab(4608,S.Db,S.Db,[S.a,A.j,A.p]),A.Ab(1073742336,_.b,_.b,[]),A.Ab(1073742336,M.m,M.m,[]),A.Ab(1073742336,M.g,M.g,[]),A.Ab(1073742336,S.yb,S.yb,[]),A.Ab(1073742336,i.n,i.n,[[2,i.s],[2,i.m]]),A.Ab(1073742336,a,a,[]),A.Ab(1073742336,D,D,[]),A.Ab(1024,i.k,(function(){return[[{path:"",component:O}]]}),[])])}))}}]);