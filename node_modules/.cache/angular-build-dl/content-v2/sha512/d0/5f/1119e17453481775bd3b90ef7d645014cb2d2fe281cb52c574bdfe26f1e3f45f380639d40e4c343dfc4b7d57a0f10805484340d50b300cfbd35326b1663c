(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{"+plB":function(l,n,t){"use strict";t.r(n);var u=t("8Y7J");class e{}var T=t("pMnS"),i=t("MKJQ"),E=t("sZkV"),A=t("SVse"),o=t("6GXZ"),I=t("xoVG"),D=t("kwUn"),S=t("b6o4");class s{constructor(l,n,t,u,e,T,i){this.userService=l,this.router=n,this.network=t,this.platform=u,this.sqlite=e,this.activatedRoute=T,this.screenOrientation=i,this.database_name="AUDIT_DB.db",this.show_Section=!1,this.show_Question=-1,this.myImgUrl="../../assets/red_lock_48.png",this.activatedRoute.queryParams.subscribe(l=>{console.log(JSON.parse(l.value)),this.Query_data=JSON.parse(l.value),console.log("list page"),console.log(this.Query_data.AttemptedId),String(this.Query_data.refresh),this.createDB()}),this.platform.ready().then(()=>{this.createDB(),this.setLandscape()}).catch(l=>{console.log(l)})}setLandscape(){this.screenOrientation.lock(this.screenOrientation.ORIENTATIONS.LANDSCAPE)}GotoQuestionChoice(l,n,t){this.router.navigate(["/audit-choice-question"],{queryParams:{value:JSON.stringify({AttemptedId:l,AuditId:this.Query_data.AuditId,SectionId:n,QuestionID:t,Store_id:this.AuditStore})}})}ngOnInit(){this.setLandscape()}createDB(){console.log("database created"),this.sqlite.create({name:this.database_name,location:"default"}).then(l=>{this.databaseObj=l,this.fetchAttemptedAuditForStore(Number(this.Query_data.AuditId),String(this.Query_data.Storeid)),this.fetchAttemptedSection(Number(this.Query_data.AttemptedId),Number(this.Query_data.AuditId))}).catch(l=>{alert("error "+JSON.stringify(l))})}fetchAttemptedAuditForStore(l,n){this.databaseObj.executeSql("SELECT * from AUDIT_ATTEMPTED_TB where AUDIT_ID="+l+" AND STR_CODE='"+n+"' ORDER BY ATTEMPTED_ID DESC",[]).then(l=>{if(this.AttemptedAuditForStore=[],console.log(l),l.rows.length>0){for(var n=0;n<l.rows.length;n++)this.AttemptedAuditForStore.push(l.rows.item(n));this.AuditStore=this.AttemptedAuditForStore[0].STR_NAME,this.AuditDate=this.AttemptedAuditForStore[0].AUDIT_DT}}).catch(l=>{console.log("error "+JSON.stringify(l))})}fetchAttemptedSection(l,n){this.databaseObj.executeSql("SELECT B.SECTION_NAME AS P_SECTION_NAME,A.ATTEMPTED_ID,A.AUDIT_ID,A.SECTION_ID,A.PARENT_SECTION_ID,A.SECTION_NAME,A.SECTION_DESC,A.SECTION_ORDER,A.SECTION_PT,A.T_QUESTION_COUNT,((SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND AUDIT_ID=A.AUDIT_ID AND SECTION_ID=A.SECTION_ID AND QUESTION_STATUS<>'Open')+(SELECT COUNT(*) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND AUDIT_ID=A.AUDIT_ID AND QUESTION_STATUS<>'Open' AND SECTION_ID IN(SELECT SECTION_ID FROM AUDIT_ATTEMPTED_SECTION WHERE PARENT_SECTION_ID=A.SECTION_ID))) AS ATTEMPTQUESTION,(SELECT SUM(QUESTION_MARKS) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND SECTION_ID=A.SECTION_ID AND IS_INCLUDED='Yes') AS SECTION_MARKS,(IFNULL((SELECT SUM(MARKS_SCORED) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND SECTION_ID=A.SECTION_ID AND IS_INCLUDED='Yes'),0)+IFNULL((SELECT SUM(MARKS_SCORED) FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID=A.ATTEMPTED_ID AND IS_INCLUDED='Yes' AND SECTION_ID IN(SELECT SECTION_ID FROM AUDIT_ATTEMPTED_SECTION WHERE PARENT_SECTION_ID=A.SECTION_ID)),0)) AS MARKS_SCORED FROM AUDIT_ATTEMPTED_SECTION A LEFT JOIN AUDIT_ATTEMPTED_SECTION B ON A.PARENT_SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID=B.ATTEMPTED_ID WHERE A.ATTEMPTED_ID="+l+" AND A.S_QUESTION_COUNT>0",[]).then(l=>{if(this.AttemptedSection=[],console.log(l),l.rows.length>0){for(var n=0;n<l.rows.length;n++)this.AttemptedSection.push(l.rows.item(n));console.log("section akshay"),console.log(this.AttemptedSection)}}).catch(l=>{console.log("error "+JSON.stringify(l))})}fetchAttemptedAuditBySQL(l,n){this.databaseObj.executeSql("SELECT AUDIT_ID,AUDIT_NAME,STR_CODE,STR_NAME,USER_ID,STR_MANAGER,AUDIT_DT,UNIQUE_ID FROM AUDIT_ATTEMPTED_TB WHERE ATTEMPTED_ID="+l+" AND AUDIT_ID="+n,[]).then(l=>{if(this.AttemptedAuditBySQL=[],console.log(l),l.rows.length>0){for(var n=0;n<l.rows.length;n++)this.AttemptedAuditBySQL.push(l.rows.item(n));return this.AttemptedAuditBySQL}}).catch(l=>{alert("error "+JSON.stringify(l))})}fetchAttemptedSectionQuestionBySQL(l,n,t,u){if("Audit"==l?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+n+" AND A.AUDIT_ID="+t,[]).then(l=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(l),l.rows.length>0)for(var n=0;n<l.rows.length;n++)this.AttemptedSectionQuestionBySQL.push(l.rows.item(n))}).catch(l=>{alert("error "+JSON.stringify(l))}):"Section"==l?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+n+" AND A.AUDIT_ID="+t+" AND A.SECTION_ID="+u,[]).then(l=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(l),l.rows.length>0)for(var n=0;n<l.rows.length;n++)this.AttemptedSectionQuestionBySQL.push(l.rows.item(n))}).catch(l=>{alert("error "+JSON.stringify(l))}):"Question"==l?this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+n+" AND A.AUDIT_ID="+t+" AND B.QUESTION_ID="+u,[]).then(l=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(l),l.rows.length>0)for(var n=0;n<l.rows.length;n++)this.AttemptedSectionQuestionBySQL.push(l.rows.item(n))}).catch(l=>{alert("error "+JSON.stringify(l))}):this.databaseObj.executeSql("SELECT A.SECTION_ID,A.SECTION_NAME,A.SECTION_ORDER,B.QUESTION_ID,B.QUESTION_NAME,B.QUESTION_ORDER,B.QUESTION_TYPE_ID,B.QUESTION_TYPE,B.QUESTION_COMMENT,B.IMAGE_NAME FROM AUDIT_ATTEMPTED_SECTION A,AUDIT_ATTEMPTED_QUESTIONS B WHERE A.ATTEMPTED_ID=B.ATTEMPTED_ID AND A.AUDIT_ID=B.AUDIT_ID AND A.SECTION_ID=B.SECTION_ID AND A.ATTEMPTED_ID="+n+" AND A.AUDIT_ID="+t+" AND 1=2",[]).then(l=>{if(this.AttemptedSectionQuestionBySQL=[],console.log(l),l.rows.length>0)for(var n=0;n<l.rows.length;n++)this.AttemptedSectionQuestionBySQL.push(l.rows.item(n))}).catch(l=>{alert("error "+JSON.stringify(l))}),this.AttemptedSectionQuestionBySQL.length>0)return this.AttemptedSectionQuestionBySQL}fetchAttemptedQuestionBySQL(l,n,t){this.show_Question=this.show_Question===t?-1:t,console.log(l),console.log("Entered in fetched question"),this.databaseObj.executeSql("SELECT ATTEMPTED_ID,AUDIT_ID,SECTION_ID,QUESTION_ID,QUESTION_NAME,QUESTION_TYPE,QUESTION_TYPE_ID,QUESTION_ORDER,CASE WHEN IS_INCLUDED='Yes' THEN QUESTION_MARKS ELSE 0 END AS QUESTION_MARKS,MARKS_SCORED,QUESTION_STATUS,QUESTION_COMMENT,IS_INCLUDED,IS_CRITICAL FROM AUDIT_ATTEMPTED_QUESTIONS WHERE ATTEMPTED_ID="+l+" AND AUDIT_ID="+n+" AND SECTION_ID="+t+" ORDER BY QUESTION_ORDER",[]).then(l=>{if(this.AttemptedQuestionBySQL=[],console.log(l),l.rows.length>0){for(var n=0;n<l.rows.length;n++)this.AttemptedQuestionBySQL.push(l.rows.item(n));return this.AttemptedQuestionBySQL}}).catch(l=>{alert("error "+JSON.stringify(l))})}GoToDashboard(){this.router.navigate(["dash-board"])}}var r=t("iInd"),_=u.ob({encapsulation:0,styles:[[""]],data:{}});function c(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,11,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,10,"div",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.fetchAttemptedSection(l.context.$implicit.ATTEMPTED_ID,l.context.$implicit.AUDIT_ID)&&u),u}),null,null)),(l()(),u.qb(2,0,null,null,9,"ion-item",[],null,null,null,i.F,i.k)),u.pb(3,49152,null,0,E.F,[u.h,u.k,u.x],null,null),(l()(),u.qb(4,0,null,0,7,"table",[],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,6,"tbody",[],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,5,"tr",[],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"td",[],null,null,null,null,null)),(l()(),u.qb(8,0,null,null,0,"img",[["height","25"],["src","../../assets/tablez.png"],["width","25"]],null,null,null,null,null)),(l()(),u.qb(9,0,null,null,1,"td",[],null,null,null,null,null)),(l()(),u.Hb(10,null,[" Audit: ",""])),(l()(),u.qb(11,0,null,null,0,"td",[],null,null,null,null,null))],null,(function(l,n){l(n,10,0,n.context.$implicit.AUDIT_NAME)}))}function N(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,0,"img",[["height","40"],["src","../../assets/red_lock_48.png"],["width","50"]],null,null,null,null,null))],null,null)}function a(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,0,"img",[["height","40"],["src","../../assets/refresh1.jpg"],["width","50"]],null,null,null,null,null))],null,null)}function O(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,0,"img",[["height","30"],["src","../../assets/red_lock_48.png"],["width","30"]],null,null,null,null,null))],null,null)}function h(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,1,"span",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,0,"img",[["height","30"],["src","../../assets/thick.png"],["width","30"]],null,null,null,null,null))],null,null)}function b(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,11,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,10,"div",[["style","margin-left: 20px;"]],null,null,null,null,null)),(l()(),u.qb(2,0,null,null,9,"ion-item",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.GotoQuestionChoice(l.context.$implicit.ATTEMPTED_ID,l.parent.parent.context.$implicit.SECTION_ID,l.context.$implicit.QUESTION_ID)&&u),u}),i.F,i.k)),u.pb(3,49152,null,0,E.F,[u.h,u.k,u.x],null,null),(l()(),u.fb(16777216,null,0,1,null,O)),u.pb(5,16384,null,0,A.i,[u.L,u.I],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,0,1,null,h)),u.pb(7,16384,null,0,A.i,[u.L,u.I],{ngIf:[0,"ngIf"]},null),(l()(),u.Hb(8,0,["",""])),(l()(),u.qb(9,0,null,0,0,"br",[],null,null,null,null,null)),(l()(),u.Hb(10,0,[" Marks : "," \xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0 Scored: "," "])),(l()(),u.qb(11,0,null,0,0,"br",[],null,null,null,null,null))],(function(l,n){l(n,5,0,"Open"===n.context.$implicit.QUESTION_STATUS),l(n,7,0,"Done"===n.context.$implicit.QUESTION_STATUS)}),(function(l,n){l(n,8,0,n.context.$implicit.QUESTION_NAME),l(n,10,0,n.context.$implicit.QUESTION_MARKS,n.context.$implicit.MARKS_SCORED)}))}function d(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,b)),u.pb(2,278528,null,0,A.h,[u.L,u.I,u.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){l(n,2,0,n.component.AttemptedQuestionBySQL)}),null)}function p(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,20,"div",[],null,null,null,null,null)),(l()(),u.qb(1,0,null,null,19,"div",[],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.fetchAttemptedQuestionBySQL(l.context.$implicit.ATTEMPTED_ID,l.context.$implicit.AUDIT_ID,l.context.$implicit.SECTION_ID)&&u),u}),null,null)),(l()(),u.qb(2,0,null,null,16,"ion-item",[],null,null,null,i.F,i.k)),u.pb(3,49152,null,0,E.F,[u.h,u.k,u.x],null,null),(l()(),u.qb(4,0,null,0,14,"table",[],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,13,"tbody",[],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,8,"tr",[],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,4,"td",[["align","center"],["rowspan","2"],["width","5%"]],null,null,null,null,null)),(l()(),u.fb(16777216,null,null,1,null,N)),u.pb(9,16384,null,0,A.i,[u.L,u.I],{ngIf:[0,"ngIf"]},null),(l()(),u.fb(16777216,null,null,1,null,a)),u.pb(11,16384,null,0,A.i,[u.L,u.I],{ngIf:[0,"ngIf"]},null),(l()(),u.qb(12,0,null,null,2,"td",[["align","left"],["style","font-size:large;"],["width","95%"]],null,null,null,null,null)),(l()(),u.qb(13,0,null,null,1,"b",[],null,null,null,null,null)),(l()(),u.Hb(14,null,[" Section: ","\xa0 \xa0\xa0 \xa0",""])),(l()(),u.qb(15,0,null,null,3,"tr",[],null,null,null,null,null)),(l()(),u.qb(16,0,null,null,2,"td",[["align","left"]],null,null,null,null,null)),(l()(),u.Hb(17,null,[" ",", Total Questions: "," Question Answered: "," Markes Scored(%): "," "])),u.Db(0,A.n,[]),(l()(),u.fb(16777216,null,null,1,null,d)),u.pb(20,16384,null,0,A.i,[u.L,u.I],{ngIf:[0,"ngIf"]},null)],(function(l,n){var t=n.component;l(n,9,0,0===n.context.$implicit.MARKS_SCORED),l(n,11,0,n.context.$implicit.MARKS_SCORED>0),l(n,20,0,t.show_Question===n.context.$implicit.SECTION_ID)}),(function(l,n){var t=n.component;l(n,14,0,n.context.$implicit.SECTION_NAME,t.AuditStore),l(n,17,0,u.Ib(n,17,0,u.Cb(n,18).transform(t.AuditDate,0,10)),n.context.$implicit.T_QUESTION_COUNT,n.context.$implicit.ATTEMPTQUESTION,n.context.$implicit.MARKS_SCORED)}))}function U(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,13,"ion-header",[],null,null,null,i.D,i.i)),u.pb(1,49152,null,0,E.z,[u.h,u.k,u.x],null,null),(l()(),u.qb(2,0,null,0,11,"div",[["style","background-color: black; align-content: center;"]],null,null,null,null,null)),(l()(),u.qb(3,0,null,null,10,"table",[["style","margin-left: 10px; margin-top: 5px; margin-bottom: 2px;"]],null,null,null,null,null)),(l()(),u.qb(4,0,null,null,9,"tbody",[],null,null,null,null,null)),(l()(),u.qb(5,0,null,null,8,"tr",[],null,null,null,null,null)),(l()(),u.qb(6,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),u.qb(7,0,null,null,1,"span",[["style","margin-top:20px; margin-left: 5px; margin-top: 1px;"]],null,null,null,null,null)),(l()(),u.qb(8,0,null,null,0,"img",[["height","35"],["src","../../assets/tablez.png"],["width","35"]],null,null,null,null,null)),(l()(),u.qb(9,0,null,null,1,"td",[],null,null,null,null,null)),(l()(),u.Hb(-1,null,["\xa0"])),(l()(),u.qb(11,0,null,null,2,"td",[],null,null,null,null,null)),(l()(),u.qb(12,0,null,null,1,"span",[["style","color: white; margin-top: 1px;"]],null,null,null,null,null)),(l()(),u.Hb(-1,null,["List Audit"])),(l()(),u.qb(14,0,null,null,5,"ion-content",[],null,null,null,i.z,i.e)),u.pb(15,49152,null,0,E.s,[u.h,u.k,u.x],null,null),(l()(),u.fb(16777216,null,0,1,null,c)),u.pb(17,278528,null,0,A.h,[u.L,u.I,u.q],{ngForOf:[0,"ngForOf"]},null),(l()(),u.fb(16777216,null,0,1,null,p)),u.pb(19,278528,null,0,A.h,[u.L,u.I,u.q],{ngForOf:[0,"ngForOf"]},null),(l()(),u.qb(20,0,null,null,4,"ion-footer",[["class","ion-no-border"]],null,null,null,i.B,i.g)),u.pb(21,49152,null,0,E.x,[u.h,u.k,u.x],null,null),(l()(),u.qb(22,0,null,0,2,"ion-button",[["color","medium"],["expand","full"]],null,[[null,"click"]],(function(l,n,t){var u=!0;return"click"===n&&(u=!1!==l.component.GoToDashboard()&&u),u}),i.w,i.b)),u.pb(23,49152,null,0,E.i,[u.h,u.k,u.x],{color:[0,"color"],expand:[1,"expand"]},null),(l()(),u.Hb(-1,0,["EXIT"]))],(function(l,n){var t=n.component;l(n,17,0,t.AttemptedAuditForStore),l(n,19,0,t.AttemptedSection),l(n,23,0,"medium","full")}),null)}function M(l){return u.Jb(0,[(l()(),u.qb(0,0,null,null,1,"app-list-audit",[],null,null,null,U,_)),u.pb(1,114688,null,0,s,[D.a,r.m,I.a,E.Eb,o.a,r.a,S.a],null,null)],(function(l,n){l(n,1,0)}),null)}var Q=u.mb("app-list-audit",s,M,{},{},[]),m=t("s7LF");class C{}t.d(n,"ListAuditPageModuleNgFactory",(function(){return g}));var g=u.nb(e,[],(function(l){return u.zb([u.Ab(512,u.j,u.Y,[[8,[T.a,Q]],[3,u.j],u.v]),u.Ab(4608,A.k,A.j,[u.s,[2,A.r]]),u.Ab(4608,m.o,m.o,[]),u.Ab(4608,E.a,E.a,[u.x,u.g]),u.Ab(4608,E.Bb,E.Bb,[E.a,u.j,u.p]),u.Ab(4608,E.Fb,E.Fb,[E.a,u.j,u.p]),u.Ab(1073742336,A.b,A.b,[]),u.Ab(1073742336,m.n,m.n,[]),u.Ab(1073742336,m.g,m.g,[]),u.Ab(1073742336,E.zb,E.zb,[]),u.Ab(1073742336,r.n,r.n,[[2,r.s],[2,r.m]]),u.Ab(1073742336,C,C,[]),u.Ab(1073742336,e,e,[]),u.Ab(1024,r.k,(function(){return[[{path:"",component:s}]]}),[])])}))}}]);